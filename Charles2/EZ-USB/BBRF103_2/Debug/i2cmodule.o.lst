   1              		.cpu arm926ej-s
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 34, 0
  11              		.eabi_attribute 18, 4
  12              		.file	"i2cmodule.c"
  13              		.text
  14              	.Ltext0:
  15              		.cfi_sections	.debug_frame
  16              		.align	2
  17              		.global	CyFxI2cInit
  19              	CyFxI2cInit:
  20              	.LFB0:
  21              		.file 1 "../i2cmodule.c"
   1:../i2cmodule.c **** /*
   2:../i2cmodule.c ****  * i2cmodule.c
   3:../i2cmodule.c ****  *
   4:../i2cmodule.c ****  *  Created on: Mar 14, 2017
   5:../i2cmodule.c ****  *      Author: Oscar
   6:../i2cmodule.c ****  */
   7:../i2cmodule.c **** 
   8:../i2cmodule.c **** #include "cyu3system.h"
   9:../i2cmodule.c **** #include "cyu3os.h"
  10:../i2cmodule.c **** #include "cyu3dma.h"
  11:../i2cmodule.c **** #include "cyu3error.h"
  12:../i2cmodule.c **** #include "cyu3usb.h"
  13:../i2cmodule.c **** #include "cyu3i2c.h"
  14:../i2cmodule.c **** #include "i2cmodule.h"
  15:../i2cmodule.c **** 
  16:../i2cmodule.c **** CyU3PReturnStatus_t
  17:../i2cmodule.c **** CyFxI2cInit ()
  18:../i2cmodule.c **** {
  22              		.loc 1 18 0
  23              		.cfi_startproc
  24              		@ args = 0, pretend = 0, frame = 24
  25              		@ frame_needed = 1, uses_anonymous_args = 0
  26 0000 00482DE9 		stmfd	sp!, {fp, lr}
  27              	.LCFI0:
  28              		.cfi_def_cfa_offset 8
  29              		.cfi_offset 11, -8
  30              		.cfi_offset 14, -4
  31 0004 04B08DE2 		add	fp, sp, #4
  32              	.LCFI1:
  33              		.cfi_def_cfa 11, 4
  34 0008 18D04DE2 		sub	sp, sp, #24
  19:../i2cmodule.c ****     CyU3PI2cConfig_t i2cConfig;
  20:../i2cmodule.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
  35              		.loc 1 20 0
  36 000c 0030A0E3 		mov	r3, #0
  37 0010 08300BE5 		str	r3, [fp, #-8]
  21:../i2cmodule.c **** 
  22:../i2cmodule.c ****     /* Initialize and configure the I2C master module. */
  23:../i2cmodule.c ****     status = CyU3PI2cInit ();
  38              		.loc 1 23 0
  39 0014 FEFFFFEB 		bl	CyU3PI2cInit
  40 0018 08000BE5 		str	r0, [fp, #-8]
  24:../i2cmodule.c ****     if (status != CY_U3P_SUCCESS)
  41              		.loc 1 24 0
  42 001c 08301BE5 		ldr	r3, [fp, #-8]
  43 0020 000053E3 		cmp	r3, #0
  44 0024 0100000A 		beq	.L2
  25:../i2cmodule.c ****     {
  26:../i2cmodule.c ****         return status;
  45              		.loc 1 26 0
  46 0028 08301BE5 		ldr	r3, [fp, #-8]
  47 002c 120000EA 		b	.L4
  48              	.L2:
  27:../i2cmodule.c ****     }
  28:../i2cmodule.c **** 
  29:../i2cmodule.c ****     /* Start the I2C master block. The bit rate is set at 100KHz.
  30:../i2cmodule.c ****      * The data transfer is done via DMA. */
  31:../i2cmodule.c ****     CyU3PMemSet ((uint8_t *)&i2cConfig, 0, sizeof(i2cConfig));
  49              		.loc 1 31 0
  50 0030 18304BE2 		sub	r3, fp, #24
  51 0034 0300A0E1 		mov	r0, r3
  52 0038 0010A0E3 		mov	r1, #0
  53 003c 1020A0E3 		mov	r2, #16
  54 0040 FEFFFFEB 		bl	CyU3PMemSet
  32:../i2cmodule.c ****     i2cConfig.bitRate    = CY_FX_USBI2C_I2C_BITRATE;
  55              		.loc 1 32 0
  56 0044 3C309FE5 		ldr	r3, .L5
  57 0048 18300BE5 		str	r3, [fp, #-24]
  33:../i2cmodule.c ****     i2cConfig.busTimeout = 0xFFFFFFFF;
  58              		.loc 1 33 0
  59 004c 0030E0E3 		mvn	r3, #0
  60 0050 10300BE5 		str	r3, [fp, #-16]
  34:../i2cmodule.c ****     i2cConfig.dmaTimeout = 0xFFFF;
  61              		.loc 1 34 0
  62 0054 0030E0E3 		mvn	r3, #0
  63 0058 BC304BE1 		strh	r3, [fp, #-12]	@ movhi
  35:../i2cmodule.c ****     i2cConfig.isDma      = CyFalse;
  64              		.loc 1 35 0
  65 005c 0030A0E3 		mov	r3, #0
  66 0060 14300BE5 		str	r3, [fp, #-20]
  36:../i2cmodule.c **** 
  37:../i2cmodule.c ****     status = CyU3PI2cSetConfig (&i2cConfig, NULL);
  67              		.loc 1 37 0
  68 0064 18304BE2 		sub	r3, fp, #24
  69 0068 0300A0E1 		mov	r0, r3
  70 006c 0010A0E3 		mov	r1, #0
  71 0070 FEFFFFEB 		bl	CyU3PI2cSetConfig
  72 0074 08000BE5 		str	r0, [fp, #-8]
  38:../i2cmodule.c ****     return status;
  73              		.loc 1 38 0
  74 0078 08301BE5 		ldr	r3, [fp, #-8]
  75              	.L4:
  39:../i2cmodule.c **** }
  76              		.loc 1 39 0
  77 007c 0300A0E1 		mov	r0, r3
  78 0080 04D04BE2 		sub	sp, fp, #4
  79              		@ sp needed
  80 0084 0088BDE8 		ldmfd	sp!, {fp, pc}
  81              	.L6:
  82              		.align	2
  83              	.L5:
  84 0088 801A0600 		.word	400000
  85              		.cfi_endproc
  86              	.LFE0:
  88              		.align	2
  89              		.global	CyFxUsbI2cTransfer
  91              	CyFxUsbI2cTransfer:
  92              	.LFB1:
  40:../i2cmodule.c **** 
  41:../i2cmodule.c **** /* I2C read / write for application. */
  42:../i2cmodule.c **** CyU3PReturnStatus_t
  43:../i2cmodule.c **** CyFxUsbI2cTransfer (
  44:../i2cmodule.c ****         uint8_t   byteAddress,
  45:../i2cmodule.c ****         uint8_t   devAddr,
  46:../i2cmodule.c ****         uint8_t   byteCount,
  47:../i2cmodule.c ****         uint8_t   *buffer,
  48:../i2cmodule.c ****         CyBool_t  isRead)
  49:../i2cmodule.c **** {
  93              		.loc 1 49 0
  94              		.cfi_startproc
  95              		@ args = 4, pretend = 0, frame = 24
  96              		@ frame_needed = 1, uses_anonymous_args = 0
  97 008c 00482DE9 		stmfd	sp!, {fp, lr}
  98              	.LCFI2:
  99              		.cfi_def_cfa_offset 8
 100              		.cfi_offset 11, -8
 101              		.cfi_offset 14, -4
 102 0090 04B08DE2 		add	fp, sp, #4
 103              	.LCFI3:
 104              		.cfi_def_cfa 11, 4
 105 0094 18D04DE2 		sub	sp, sp, #24
 106 0098 1C300BE5 		str	r3, [fp, #-28]
 107 009c 0030A0E1 		mov	r3, r0
 108 00a0 15304BE5 		strb	r3, [fp, #-21]
 109 00a4 0130A0E1 		mov	r3, r1
 110 00a8 16304BE5 		strb	r3, [fp, #-22]
 111 00ac 0230A0E1 		mov	r3, r2
 112 00b0 17304BE5 		strb	r3, [fp, #-23]
  50:../i2cmodule.c ****     CyU3PI2cPreamble_t preamble;
  51:../i2cmodule.c ****     CyU3PReturnStatus_t status = CY_U3P_SUCCESS;
 113              		.loc 1 51 0
 114 00b4 0030A0E3 		mov	r3, #0
 115 00b8 08300BE5 		str	r3, [fp, #-8]
  52:../i2cmodule.c **** 
  53:../i2cmodule.c ****     if (byteCount == 0)
 116              		.loc 1 53 0
 117 00bc 17305BE5 		ldrb	r3, [fp, #-23]	@ zero_extendqisi2
 118 00c0 000053E3 		cmp	r3, #0
 119 00c4 0100001A 		bne	.L8
  54:../i2cmodule.c ****     {
  55:../i2cmodule.c ****         return CY_U3P_SUCCESS;
 120              		.loc 1 55 0
 121 00c8 0030A0E3 		mov	r3, #0
 122 00cc 2E0000EA 		b	.L12
 123              	.L8:
  56:../i2cmodule.c ****     }
  57:../i2cmodule.c **** 
  58:../i2cmodule.c **** 	if (isRead)
 124              		.loc 1 58 0
 125 00d0 04309BE5 		ldr	r3, [fp, #4]
 126 00d4 000053E3 		cmp	r3, #0
 127 00d8 1800000A 		beq	.L10
  59:../i2cmodule.c **** 	{
  60:../i2cmodule.c **** 		/* Update the preamble information. */
  61:../i2cmodule.c **** 		preamble.length    = 3;
 128              		.loc 1 61 0
 129 00dc 0330A0E3 		mov	r3, #3
 130 00e0 0C304BE5 		strb	r3, [fp, #-12]
  62:../i2cmodule.c **** 		preamble.buffer[0] = devAddr;
 131              		.loc 1 62 0
 132 00e4 16305BE5 		ldrb	r3, [fp, #-22]
 133 00e8 14304BE5 		strb	r3, [fp, #-20]
  63:../i2cmodule.c **** 		preamble.buffer[1] = byteAddress;
 134              		.loc 1 63 0
 135 00ec 15305BE5 		ldrb	r3, [fp, #-21]
 136 00f0 13304BE5 		strb	r3, [fp, #-19]
  64:../i2cmodule.c **** 		preamble.buffer[2] = (devAddr | 0x01);
 137              		.loc 1 64 0
 138 00f4 16305BE5 		ldrb	r3, [fp, #-22]
 139 00f8 013083E3 		orr	r3, r3, #1
 140 00fc FF3003E2 		and	r3, r3, #255
 141 0100 12304BE5 		strb	r3, [fp, #-18]
  65:../i2cmodule.c **** 		preamble.ctrlMask  = 0x0002; // stop position
 142              		.loc 1 65 0
 143 0104 0230A0E3 		mov	r3, #2
 144 0108 BA304BE1 		strh	r3, [fp, #-10]	@ movhi
  66:../i2cmodule.c **** 
  67:../i2cmodule.c **** 		status = CyU3PI2cReceiveBytes (&preamble, buffer, byteCount, 0);
 145              		.loc 1 67 0
 146 010c 17305BE5 		ldrb	r3, [fp, #-23]	@ zero_extendqisi2
 147 0110 14204BE2 		sub	r2, fp, #20
 148 0114 0200A0E1 		mov	r0, r2
 149 0118 1C101BE5 		ldr	r1, [fp, #-28]
 150 011c 0320A0E1 		mov	r2, r3
 151 0120 0030A0E3 		mov	r3, #0
 152 0124 FEFFFFEB 		bl	CyU3PI2cReceiveBytes
 153 0128 08000BE5 		str	r0, [fp, #-8]
  68:../i2cmodule.c **** 		if (status != CY_U3P_SUCCESS)
 154              		.loc 1 68 0
 155 012c 08301BE5 		ldr	r3, [fp, #-8]
 156 0130 000053E3 		cmp	r3, #0
 157 0134 1300000A 		beq	.L11
  69:../i2cmodule.c **** 		{
  70:../i2cmodule.c **** 			return status;
 158              		.loc 1 70 0
 159 0138 08301BE5 		ldr	r3, [fp, #-8]
 160 013c 120000EA 		b	.L12
 161              	.L10:
  71:../i2cmodule.c **** 		}
  72:../i2cmodule.c **** 	}
  73:../i2cmodule.c **** 	else /* Write */
  74:../i2cmodule.c **** 	{
  75:../i2cmodule.c **** 		/* Update the preamble information. */
  76:../i2cmodule.c **** 		preamble.length    = 2;
 162              		.loc 1 76 0
 163 0140 0230A0E3 		mov	r3, #2
 164 0144 0C304BE5 		strb	r3, [fp, #-12]
  77:../i2cmodule.c **** 		preamble.buffer[0] = devAddr;
 165              		.loc 1 77 0
 166 0148 16305BE5 		ldrb	r3, [fp, #-22]
 167 014c 14304BE5 		strb	r3, [fp, #-20]
  78:../i2cmodule.c **** 		preamble.buffer[1] = byteAddress;
 168              		.loc 1 78 0
 169 0150 15305BE5 		ldrb	r3, [fp, #-21]
 170 0154 13304BE5 		strb	r3, [fp, #-19]
  79:../i2cmodule.c **** 		preamble.ctrlMask  = 0x0000;
 171              		.loc 1 79 0
 172 0158 0030A0E3 		mov	r3, #0
 173 015c BA304BE1 		strh	r3, [fp, #-10]	@ movhi
  80:../i2cmodule.c **** 		status = CyU3PI2cTransmitBytes (&preamble, buffer, byteCount, 0);
 174              		.loc 1 80 0
 175 0160 17305BE5 		ldrb	r3, [fp, #-23]	@ zero_extendqisi2
 176 0164 14204BE2 		sub	r2, fp, #20
 177 0168 0200A0E1 		mov	r0, r2
 178 016c 1C101BE5 		ldr	r1, [fp, #-28]
 179 0170 0320A0E1 		mov	r2, r3
 180 0174 0030A0E3 		mov	r3, #0
 181 0178 FEFFFFEB 		bl	CyU3PI2cTransmitBytes
 182 017c 08000BE5 		str	r0, [fp, #-8]
  81:../i2cmodule.c ****         return status;
 183              		.loc 1 81 0
 184 0180 08301BE5 		ldr	r3, [fp, #-8]
 185 0184 000000EA 		b	.L12
 186              	.L11:
  82:../i2cmodule.c **** 	}
  83:../i2cmodule.c **** 
  84:../i2cmodule.c ****     return CY_U3P_SUCCESS;
 187              		.loc 1 84 0
 188 0188 0030A0E3 		mov	r3, #0
 189              	.L12:
  85:../i2cmodule.c **** }
 190              		.loc 1 85 0
 191 018c 0300A0E1 		mov	r0, r3
 192 0190 04D04BE2 		sub	sp, fp, #4
 193              		@ sp needed
 194 0194 0088BDE8 		ldmfd	sp!, {fp, pc}
 195              		.cfi_endproc
 196              	.LFE1:
 198              	.Letext0:
 199              		.file 2 "d:\\program files (x86)\\cypress\\ez-usb fx3 sdk\\1.3\\arm gcc\\arm-none-eabi\\include\\s
 200              		.file 3 "D:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\\\firmware\\u3p_firmware\\inc/cyu3
 201              		.file 4 "D:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\\\firmware\\u3p_firmware\\inc/cyu3
 202              		.file 5 "D:\\Program Files (x86)\\Cypress\\EZ-USB FX3 SDK\\1.3\\\\firmware\\u3p_firmware\\inc/cyu3
DEFINED SYMBOLS
                            *ABS*:00000000 i2cmodule.c
C:\Users\jason\AppData\Local\Temp\ccXKTgND.s:16     .text:00000000 $a
C:\Users\jason\AppData\Local\Temp\ccXKTgND.s:19     .text:00000000 CyFxI2cInit
C:\Users\jason\AppData\Local\Temp\ccXKTgND.s:84     .text:00000088 $d
C:\Users\jason\AppData\Local\Temp\ccXKTgND.s:88     .text:0000008c $a
C:\Users\jason\AppData\Local\Temp\ccXKTgND.s:91     .text:0000008c CyFxUsbI2cTransfer
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
CyU3PI2cInit
CyU3PMemSet
CyU3PI2cSetConfig
CyU3PI2cReceiveBytes
CyU3PI2cTransmitBytes
